
<div class="contents row">
  <div class="container">
    <%= form_with model: @post, url:posts_path, method: :post, local: true do |f| %>
      <%= f.text_area :content, placeholder: "text", rows: "5" %>
      <%= f.hidden_field :user_id %>
      <%= f.submit "投稿" %>
    <% end %>
  </div>
</div>

<div class="comment">
  <% @posts.each do |post| %>
    <div class="comments">
      <%= post.content %>
    </div>
    <% if user_signed_in? %>
      <% if post.liked_by?(current_user) %>
          <p><%=link_to post.likes.count, post_likes_path(post.id), method: :delete, class: "fas fa-heart" %></p>
      <% else %>
          <p><%=link_to post.likes.count, post_likes_path(post.id), method: :post, class: "fas fa-heart" %></p>
      <% end %>
    <% else %>
      <p><span>お気に入り数: </span><%= post.likes.count %></p>
    <% end %>
    
    <%= form_with model: [post, @comment], local: true do |f| %>
      <%= f.text_field :content %>
      <%= f.hidden_field :user_id %>
      <%= f.submit "投稿" %>
    <% end %>
    
    <% post.comments.each do |comment| %>
    <ul class="media-list">
      <li class="media">
        <%= attachment_image_tag user, :image, fallback: "no_image.jpg", class: "pull-left", size: "100x100" %>
        <%= comment.content %>
      </li>
    </ul>
    <% end %>
    
  <% end %>
</div>
<%= paginate @posts %>
</div>