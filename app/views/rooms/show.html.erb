<div class="row">
	<div class="sidebar col-lg-2">
    <h2 class="text-white">ルーム：<%= @room.name %> </h2>
  	<%= link_to "マイページに戻る", user_path(current_user), class: "btn btn-primary" %>
  	<h4 class="text-light mt-3">ルームメンバー</h4>
  　　<% @room.users.each do |user| %>
          <p><%= link_to user.name, user_path(user) %></br>
          [最終ログイン]<%= user.current_sign_in_at.strftime('%-m/%-d %-H:%-M') %>
          <%= render 'tasks/chart', tasks: user.tasks, user: user  %>
          <%#<%= render 'tasks/chart', tasks: Task.where(user_id: user.id)  %>
          <!--<canvas id="myPieChart<= user.id %>"></canvas>-->
          <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>-->

          // <script>
          // var ctx = document.getElementById("myPieChart<= user.id %>");
          // var myPieChart = new Chart(ctx, {
          //   type: 'pie',
          //   data: {
          //     labels: ["完了", "未完了",],
          //     datasets: [{
          //         backgroundColor: [
          //             "#BB5179",
          //             // "#FAFF67",
          //             // "#58A27C",
          //             "#3C00FF"
          //         ],
          //         data: [<= user.tasks.where(status: "完了").count %>,<= user.tasks.where(status: "未完了").count %>]
          //     }]
          //   },
          //   options: {
          //     title: {
          //       display: true,
          //       text: 'タスク進捗度'
          //     }
          //   }
          // });
          // </script>

          </p>
      <% end %>
	</div>
	<div class="col-lg-7">
      <h3 class="text-white mt-5">ルームメンバーの投稿一覧</h3>
    <div class="py-4 px-4 bg-light">
      <%= render "posts/form", post: @post %>
    </div>
    <% @posts.each do |post| %>
      <div class="py-4 px-4 bg-light mt-3">
        <%= post.content %>
        <div>
          <% if post.liked_by?(current_user) %>
              <%=link_to "いいね:#{post.likes.count}", post_likes_path(post.id), method: :delete %>
          <% else %>
              <%=link_to "いいね:#{post.likes.count}", post_likes_path(post.id), method: :post %>
          <% end %>
          <%= "コメント数:#{post.comments.count}" %>
        </div>
        <% post.comments.each do |comment| %>
          <ul class="media-list">
            <li class="media">
              <%= attachment_image_tag comment.user, :image, :fill, 40, 40, fallback: "no_image.jpg" %>
              <%= comment.user.name %>
              <%= comment.created_at.strftime('%m月%d日 %H時%M分') %></br>
              <%= comment.content %>
            </li>
          </ul>
        <% end %>

        <%= form_with model: [post, @comment], local: true do |f| %>
          <%= f.text_field :content, class: "form-control", placeholder: "コメントを入力" %>
          <%= f.hidden_field :user_id %>
          <%= f.submit "コメントする", class: "btn btn-info mt-2" %>
        <% end %>
      </div>
    <% end %>
	</div>
	<div class="col-lg-3">
	<h3 class="text-white mt-5">ルームチャット</h3>
	<div class="bg-light py-4 px-4">
    <%= form_with model: @chat, url:chats_path, method: :post, local: true do |f| %>
        <%= f.text_field :content, class: "form-control", placeholder: "チャット" %>
        <%= f.hidden_field :room_id %>
    <% end %>
	  <% @chats.each do |chat| %>
      [<%= chat.user.name %>]
      <%= chat.content %></br>
    <% end %>
	</div>
	</div>

</div>